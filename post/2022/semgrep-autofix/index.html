<!doctype html><html lang=fa dir=rtl><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ูุงุจูุช ุชุฑูู ุฎูุฏฺฉุงุฑ Semgrep | ุงููุช ู ุบุฑู ุจู ูุงุฑุณ</title><meta name=keywords content><meta name=description content="ุฏุฑ ุงู ููุดุชุงุฑ ูโุฎูุงูู ุฏุฑ ููุฑุฏ ูุงุจูุช ุชุฑููู ุฎูุฏฺฉุงุฑ (autofix) ฺฉูุฏ Semgrep ุตุญุจุช ฺฉูู. ุงู ูุงุจูุช ุขุฒูุงุด ุจู ูุง ุงูฺฉุงู ูโุฏูุฏ ฺฉู ุจุนุฏ ุงุฒ ุงูุชู ูุชุงุฌ ุฏุฑ ูุงููุง ููุจุนุ ุขููุง ุฑุง ุจู ุตูุฑุช ุงุชููุงุชฺฉ ุฏุณุชฺฉุงุฑ ฺฉูู.
ุงฺฏุฑ ุนูุงูู ุจู ุฎูุงูุฏู ูุณุฎู ุงูฺฏูุณ ุฏุงุฑุฏ:
https://parsiya.net/blog/2021-10-25-a-hands-on-intro-to-semgreps-autofix/ ููู ูููููโูุง ุฏุฑ Semgrep playground ูุณุชูุฏ ูู ูโุชูุงูุฏ ุขููุง ุฑุง ุขููุงู ูุฒ ุงุฌุฑุง ฺฉูุฏ:
https://github.com/parsiya/Parsia-Code/tree/master/semgrep-autofix ูพุดโูุงุฒูุง ุงู ุจูุงฺฏ ุจุฑุง ุงุณุชูุงุฏู ุจููู ุงุฒ ุงู ุจูุงฺฏุ ุจูุชุฑ ุงุณุช ุงู ููุงุฑุฏ ุฑุง ุจุฏุงูุฏ:"><meta name=author content="ูพุงุฑุณุง"><link rel=canonical href=https://parsiya.github.io/parsiya.fa/post/2022/semgrep-autofix/><link href=/parsiya.fa/assets/css/stylesheet.min.d08f6c302eba3eaecd589684c093cecdfe7dfb8745a207401bd0583d3bb31837.css integrity="sha256-0I9sMC66Pq7NWJaEwJPOzf59+4dFogdAG9BYPTuzGDc=" rel="preload stylesheet" as=style><link rel=icon href=https://parsiya.github.io/parsiya.fa/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://parsiya.github.io/parsiya.fa/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://parsiya.github.io/parsiya.fa/favicon-32x32.png><link rel=apple-touch-icon href=https://parsiya.github.io/parsiya.fa/apple-touch-icon.png><link rel=mask-icon href=https://parsiya.github.io/parsiya.fa/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.101.0"><link rel=stylesheet href=https://parsiya.github.io/parsiya.fa/css/vazir-font.css><link rel=stylesheet href=https://parsiya.github.io/parsiya.fa/css/custom.css><meta property="og:title" content="ูุงุจูุช ุชุฑูู ุฎูุฏฺฉุงุฑ Semgrep"><meta property="og:description" content="ุฏุฑ ุงู ููุดุชุงุฑ ูโุฎูุงูู ุฏุฑ ููุฑุฏ ูุงุจูุช ุชุฑููู ุฎูุฏฺฉุงุฑ (autofix) ฺฉูุฏ Semgrep ุตุญุจุช ฺฉูู. ุงู ูุงุจูุช ุขุฒูุงุด ุจู ูุง ุงูฺฉุงู ูโุฏูุฏ ฺฉู ุจุนุฏ ุงุฒ ุงูุชู ูุชุงุฌ ุฏุฑ ูุงููุง ููุจุนุ ุขููุง ุฑุง ุจู ุตูุฑุช ุงุชููุงุชฺฉ ุฏุณุชฺฉุงุฑ ฺฉูู.
ุงฺฏุฑ ุนูุงูู ุจู ุฎูุงูุฏู ูุณุฎู ุงูฺฏูุณ ุฏุงุฑุฏ:
https://parsiya.net/blog/2021-10-25-a-hands-on-intro-to-semgreps-autofix/ ููู ูููููโูุง ุฏุฑ Semgrep playground ูุณุชูุฏ ูู ูโุชูุงูุฏ ุขููุง ุฑุง ุขููุงู ูุฒ ุงุฌุฑุง ฺฉูุฏ:
https://github.com/parsiya/Parsia-Code/tree/master/semgrep-autofix ูพุดโูุงุฒูุง ุงู ุจูุงฺฏ ุจุฑุง ุงุณุชูุงุฏู ุจููู ุงุฒ ุงู ุจูุงฺฏุ ุจูุชุฑ ุงุณุช ุงู ููุงุฑุฏ ุฑุง ุจุฏุงูุฏ:"><meta property="og:type" content="article"><meta property="og:url" content="https://parsiya.github.io/parsiya.fa/post/2022/semgrep-autofix/"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-04-23T11:40:33-07:00"><meta property="article:modified_time" content="2022-04-23T11:40:33-07:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="ูุงุจูุช ุชุฑูู ุฎูุฏฺฉุงุฑ Semgrep"><meta name=twitter:description content="ุฏุฑ ุงู ููุดุชุงุฑ ูโุฎูุงูู ุฏุฑ ููุฑุฏ ูุงุจูุช ุชุฑููู ุฎูุฏฺฉุงุฑ (autofix) ฺฉูุฏ Semgrep ุตุญุจุช ฺฉูู. ุงู ูุงุจูุช ุขุฒูุงุด ุจู ูุง ุงูฺฉุงู ูโุฏูุฏ ฺฉู ุจุนุฏ ุงุฒ ุงูุชู ูุชุงุฌ ุฏุฑ ูุงููุง ููุจุนุ ุขููุง ุฑุง ุจู ุตูุฑุช ุงุชููุงุชฺฉ ุฏุณุชฺฉุงุฑ ฺฉูู.
ุงฺฏุฑ ุนูุงูู ุจู ุฎูุงูุฏู ูุณุฎู ุงูฺฏูุณ ุฏุงุฑุฏ:
https://parsiya.net/blog/2021-10-25-a-hands-on-intro-to-semgreps-autofix/ ููู ูููููโูุง ุฏุฑ Semgrep playground ูุณุชูุฏ ูู ูโุชูุงูุฏ ุขููุง ุฑุง ุขููุงู ูุฒ ุงุฌุฑุง ฺฉูุฏ:
https://github.com/parsiya/Parsia-Code/tree/master/semgrep-autofix ูพุดโูุงุฒูุง ุงู ุจูุงฺฏ ุจุฑุง ุงุณุชูุงุฏู ุจููู ุงุฒ ุงู ุจูุงฺฏุ ุจูุชุฑ ุงุณุช ุงู ููุงุฑุฏ ุฑุง ุจุฏุงูุฏ:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://parsiya.github.io/parsiya.fa/post/"},{"@type":"ListItem","position":2,"name":"ูุงุจูุช ุชุฑูู ุฎูุฏฺฉุงุฑ Semgrep","item":"https://parsiya.github.io/parsiya.fa/post/2022/semgrep-autofix/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ูุงุจูุช ุชุฑูู ุฎูุฏฺฉุงุฑ Semgrep","name":"ูุงุจูุช ุชุฑูู ุฎูุฏฺฉุงุฑ Semgrep","description":"ุฏุฑ ุงู ููุดุชุงุฑ ูโุฎูุงูู ุฏุฑ ููุฑุฏ ูุงุจูุช ุชุฑููู ุฎูุฏฺฉุงุฑ (autofix) ฺฉูุฏ Semgrep ุตุญุจุช ฺฉูู. ุงู ูุงุจูุช ุขุฒูุงุด ุจู ูุง ุงูฺฉุงู ูโุฏูุฏ ฺฉู ุจุนุฏ ุงุฒ ุงูุชู ูุชุงุฌ ุฏุฑ ูุงููุง ููุจุนุ ุขููุง ุฑุง ุจู ุตูุฑุช ุงุชููุงุชฺฉ ุฏุณุชฺฉุงุฑ ฺฉูู.\nุงฺฏุฑ ุนูุงูู ุจู ุฎูุงูุฏู ูุณุฎู ุงูฺฏูุณ ุฏุงุฑุฏ:\nhttps://parsiya.net/blog/2021-10-25-a-hands-on-intro-to-semgreps-autofix/ ููู ูููููโูุง ุฏุฑ Semgrep playground ูุณุชูุฏ ูู ูโุชูุงูุฏ ุขููุง ุฑุง ุขููุงู ูุฒ ุงุฌุฑุง ฺฉูุฏ:\nhttps://github.com/parsiya/Parsia-Code/tree/master/semgrep-autofix ูพุดโูุงุฒูุง ุงู ุจูุงฺฏ ุจุฑุง ุงุณุชูุงุฏู ุจููู ุงุฒ ุงู ุจูุงฺฏุ ุจูุชุฑ ุงุณุช ุงู ููุงุฑุฏ ุฑุง ุจุฏุงูุฏ:","keywords":[],"articleBody":"ุฏุฑ ุงู ููุดุชุงุฑ ูโุฎูุงูู ุฏุฑ ููุฑุฏ ูุงุจูุช ุชุฑููู ุฎูุฏฺฉุงุฑ (autofix) ฺฉูุฏ Semgrep ุตุญุจุช ฺฉูู. ุงู ูุงุจูุช ุขุฒูุงุด ุจู ูุง ุงูฺฉุงู ูโุฏูุฏ ฺฉู ุจุนุฏ ุงุฒ ุงูุชู ูุชุงุฌ ุฏุฑ ูุงููุง ููุจุนุ ุขููุง ุฑุง ุจู ุตูุฑุช ุงุชููุงุชฺฉ ุฏุณุชฺฉุงุฑ ฺฉูู.\nุงฺฏุฑ ุนูุงูู ุจู ุฎูุงูุฏู ูุณุฎู ุงูฺฏูุณ ุฏุงุฑุฏ:\nhttps://parsiya.net/blog/2021-10-25-a-hands-on-intro-to-semgreps-autofix/ ููู ูููููโูุง ุฏุฑ Semgrep playground ูุณุชูุฏ ูู ูโุชูุงูุฏ ุขููุง ุฑุง ุขููุงู ูุฒ ุงุฌุฑุง ฺฉูุฏ:\nhttps://github.com/parsiya/Parsia-Code/tree/master/semgrep-autofix ูพุดโูุงุฒูุง ุงู ุจูุงฺฏ ุจุฑุง ุงุณุชูุงุฏู ุจููู ุงุฒ ุงู ุจูุงฺฏุ ุจูุชุฑ ุงุณุช ุงู ููุงุฑุฏ ุฑุง ุจุฏุงูุฏ:\nุงุณุชูุงุฏู ุงุฒ Semgrep ู ููุดุชู rule (ูุงูููุ). ฺุฑุง ุงุฒ Semgrep ุจุฑุง Static Analysis ุงุณุชูุงุฏู ฺฉููุ ุฑุง ุจุฎูุงูุฏ. ุขุดูุง ุณูุฑุณูุฑ ุจุง ุฎูุงูุฏู ฺฉุฏู Javaุ Python ู Go. ุขุดูุง ูุฎุชุตุฑ ุจุง ุจุนุถ ููุงูู ุงููุช ูุงููุฏ HttpOnly ู XSS. ูฺฉุชู: ุชุฑููู ุฎูุฏฺฉุงุฑุ ฺฉ ุงุฒ ูุงุจูุชโูุง ุขุฒูุงุด Semgrep ุงุณุช. ุฏุฑ ุฒูุงู ูฺฏุงุฑุด (ุขูุฑู 2022 ุจุฑุง ูุณุฎู ูุงุฑุณ ู ุงฺฉุชุจุฑ 2021 ุจุฑุง ูุณุฎู ุงูฺฏูุณ) ููู ูุซุงูโูุง ุฏุฑุณุช ูุณุชูุฏ. ุงฺฏุฑ ุงุฒ ุขูุฏู ูุงุฏุ ุดุงุฏ ุจุนุถ ฺุฒูุง ูุชูุงูุช ุจุงุดูุฏ.\nุงุฌุฑุง ููุงูู ุจุฑุง ุงุฌุฑุง ู ุชุณุช ููุงูู ุฏู ุฑุงู ุฏุงุฑู:\nุงุณุชูุงุฏู ุงุฒ Semgrep playground ุฏุฑ ุขุฏุฑุณ https://semgrep.dev/playground. ูู ุจุดุชุฑ ุงุฒ ุงู ุฑูุด ุงุณุชูุงุฏู ูโฺฉูู ฺูู ุฑุงุญุช ู ุณุฑุน ูโโุชูุงูู ูุงููู ุฑุง ุนูุถ ฺฉูู ู ูุชุฌู ุฑุง ุจุจูู. ุงุฌุฑุง ุฏุฑ ุฎุทู ูุฑูุงู (ุชุฑุฌูู ูุงุฑุณ command line). ุจุนุฏ ุงุฒ ููุดุชู ฺฉ ูุงููู ูโุชูุงูุฏ ุฏุฑุณุช ุณุงุฎุชุงุฑ ูุงู yaml ุขู ุฑุง ุชุณุช ฺฉูุฏ:\nsemgrep-crule1.yaml--validate ุงฺฏุฑ ฺฉ ูุงููู ุฏุงุฑุง ุจุฎุด autofix ุจุงุดุฏุ ููฺฏุงู ุงุฌุฑุง ูุงู ุงุตู ุฏุณุชฺฉุงุฑ ููโุดูุฏ ูู ูโุชูุงูุฏ ุชุบุฑุงุช ุฑุง ุจุจูุฏ. ุจุฑุง ุชุบุฑ ูุงู ุงุตู ุงุฒ ุณูฺ autofix-- ุงุณุชูุงุฏู ฺฉูุฏ. ุจุฑุง ูุดุงูุฏู ุชุบุฑุงุช ุจุฏูู ุชุบุฑ ูุงู ุงุตู ุงุฒ ุณูฺ dry-run-- ุงุณุชูุงุฏู ฺฉูุฏ (ุญุถูุฑ ููุฒูุงู autofix ู dry-run ูุนุงุฏู ูุจูุฏู autofix ุงุณุช ุนู ุชุบุฑุงุช ููุท ูุดุงู ุฏุงุฏู ูโุดููุฏ):\nsemgrep -c rule1.yaml example.java --autofix --dryrun ุงุณุชูุงุฏู ุงุฒ ุณูฺโูุง ูุฎุชูู ุฑูุดโูุง ุงุณุชูุงุฏู ุงุฒ autofix ุฏู ุฑูุด ูุฎุชูู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ autofix ุฏุงุฑู:\nfix fix-regex ูุฑูุงู Fix ูุฑ ฺุฒ ฺฉู ูุงููู ูพุฏุง ฺฉุฑุฏู ุงุณุช ุฑุง ุจุง ููุฏุงุฑ ุงู ูุฑูุงู ุฌุงฺฏุฒู ูฺฉูู. ุจูุชุฑู ฺฉุงูุฏุฏูุง ุจุฑุง ุงู ูุงุจูุชุ ุชูุงุจุน ุง ุฑุดุชู (string) ูุง ูุงุงูู ูุณุชูุฏ ฺฉู ุจุงุฏ ุจุง ูุนุงุฏู ุงูู ุฌุงฺฏุฒู ุดููุฏ. ฺูุฏ ูุซุงู ุจุง ุงู ุฏุณุชูุฑ ุจุจูู.\nPython - sys.exit ุงู ูุซุงู ุฑุง ุงุฒ ุขููุฒุด Semgrep ุฏุฑ ุขุฏุฑุณ (https://semgrep.dev/s/R6g) ูุฑุถ ฺฏุฑูุชูโุงู. ุฏุฑ ุงู ูุงููู ูุง ุจู ุฏูุจุงู ุชุงุจุน exit ูุณุชู ู ูโุฎูุงูู ุขู ุฑุง ุจุง sys.exit ุฌุงฺฏุฒู ฺฉูู. Semgrep ุชูุงูุช ุชุงุจุน exit ุจุง ุฏฺฏุฑ ุงุณุชูุงุฏูโูุง ุงู ฺฉููู ุฑุง ุฏุฑ ฺฉูุฏ ูโูููุฏ ู ูโโุชูุงูุฏ ุฑุงุญุช ุขู ุฑุง ุฌุงฺฏุฒู ฺฉูุฏ. ุจุนุฏ ุงุฒ ุงุฌุฑุง ูุงููู ุฏุฑ ูุจโุณุงุช ุจุงูุง ู ุจูุฏ ฺฉู ุฏฺฉูู Apply Fix ูุนุงู ุดุฏู ู ูโุชูุงูุฏ ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ฺฉุฏ ุจุฑูุงูู ุฑุง ุฏุณุชฺฉุงุฑ ฺฉูุฏ.\nุชุบุฑ ุงุชููุงุชฺฉ exit ุจู sys.exit ฺฉ ุงุฒ ูฺฉุงุช ุฌุงูุจ ุงู ุงุณุช ฺฉู ูโุชูุงูู ูพุงุฑุงูุชุฑ ุชุงุจุน ุฑุง ุชูุณุท ฺฉ metavariable (ุฏุฑ ุงูุฌุง ุจุง ูุงู X) ุฏุฑ ูุงููู ุฐุฎุฑู ฺฉูู ู ุฏุฑ autofix ุงุณุชูุงุฏู ฺฉูู. ุฏฺฏุฑ ูุงุฒู ูุณุช ุญุช ูฺฏุฑุงู ููุฏุงุฑ ูพุงุฑุงูุชุฑ ุจุงุดู.\nJava - CBC Padding Oracle ุจุฑุง ุงู ูุซุงูุ ูุงููู cbc-padding-oracle ุฒุจุงู ุฌุงูุง ุฑุง ุงุฒ ุฑุฌุณุชุฑ Semgrep ุฏุณุชฺฉุงุฑ ฺฉุฑุฏูโุงู ุชุง ุฑุงุญุชโุชุฑ ุฎูุงูุฏู ุดูุฏ.\n# java-cbc-padding-oracle/cbc-padding-oracle.yaml rules: - id: cbc-padding-oracle severity: WARNING message: Match found languages: - java pattern: $CIPHER.getInstance(\"=~/.*\\/CBC\\/PKCS5Padding/\") fix: $CIPHER.getInstance(\"AES/GCM/NoPadding\") ุงู ูุงููู ุจู ุฏูุจุงู ูุฑ ฺุฒ ฺฉู ุดุจู object.getInstance(\"string\") ุจุงุดุฏ ูโฺฏุฑุฏุฏ ู ุฏุฑ ุตูุฑุช ฺฉู ุฑุดุชู ุฏุงุฎู ุดุงูู CBC/PKCS5Padding ุจุงุดุฏุ ูุชุฌู ุฑุง ฺฏุฒุงุฑุด ูโุฏูุฏ. ุงู ูุงููู ุงุฒ ูุงุจูุช ูุฏู string matching ุงุณุชูุงุฏู ูโฺฉูุฏ ฺฉู ุฏฺฏุฑ ูพุดุชุจุงู ููโุดูุฏ. ุจุฑุง ุฏุณุชโฺฏุฑู ุจุงุฏ ุขู ุฑุง ุจุง metavariable-regex ุฌุงฺฏุฒู ฺฉูู. ุงู ฺฉุงุฑ ุณุงุฏู ุงุณุชุ ุงูู ฺฉ metavariable ุจู ุนููุงู ูพุงุฑุงูุชุฑ ุชุนุฑู ูโฺฉูู (ุฏุฑ ุงูุฌุง INS$) ู ุจุนุฏ regex ุฑุง ุฑู ุขู ุงุฌุฑุง ูโฺฉูู ู ูุชุฌู ููุงู ุงุณุช:\nhttps://semgrep.dev/s/parsiya:java-cbc-padding-oracle-metavariable-regex # java-cbc-padding-oracle/cbc-padding-oracle-metavariable-regex.yaml rules: - id: cbc-padding-oracle-metavariable-regex message: Match found languages: - java severity: WARNING patterns: - pattern: $CIPHER.getInstance($INS) - metavariable-regex: metavariable: $INS regex: .*\\/CBC\\/PKCS5Padding fix: $CIPHER.getInstance(\"AES/GCM/NoPadding\") ููุฏุงุฑ โูุญุงุณุจูโ ูุงููู ุฌุฏุฏ ุฏุฑ playground ุนุฏุฏ ุจุฒุฑฺฏุชุฑ ุจูุฏ ู ูู ุฎูุงุณุชู ุขู ุฑุง ุขุฒูุงุด ฺฉูู. ูุงููู ุฌุฏุฏ ุฎู ูพฺุฏูโุชุฑ ุงุฒ ูุงููู ูุฏู ูุณุช.\n$ multitime -q -n 50 ./cbc-padding-oracle.sh ===\u003e multitime results 1: -q ./cbc-padding-oracle.sh Mean Std.Dev. Min Median Max real 0.781 0.006 0.773 0.780 0.806 user 0.501 0.041 0.406 0.500 0.609 sys 0.256 0.044 0.172 0.258 0.359 $ multitime -q -n 50 ./cbc-padding-oracle-metavariable-regex.sh ===\u003e multitime results 1: -q ./cbc-padding-oracle-metavariable-regex.sh Mean Std.Dev. Min Median Max real 0.788 0.007 0.778 0.786 0.813 user 0.516 0.047 0.406 0.516 0.609 sys 0.247 0.048 0.156 0.250 0.359 ุงู ููุฏุงุฑ ูุญุงุณุจู ู ุนุฏุฏ ฺฉู ุฏุฑ playground ูุดุงู ุฏุงุฏู ูโุดูุฏ ุจุญุซ ุงุณุช ฺฉู ุจุนุฏุง ุจุงุฏ ุจู ุขู ุจูพุฑุฏุงุฒู. ุฎูุงุตู ุจฺฏูุ ูุนูููุงู ูุจุงุฏ ูฺฏุฑุงู ุนููฺฉุฑุฏ ูุงููู ุฎูุฏ ุจุงุดุฏ. ููุฏุงุฑ ุฒุงุฏ ุงุฒ ููุช Semgrep ุตุฑู ุฎูุงูุฏู ู ูพุฑุฏุงุฒุด ูุงูโูุง ู ุณูพุณ ุฏุฑุณุช ฺฉุฑุฏู Abstract Syntax Tree (AST) ฺฉูุฏ ูโุดูุฏ. ุฎู regex ูุง ูพฺุฏู ูููุณุฏ ุงูุง ุฏฺฏุฑ ูฺฏุฑุงู ุฐุฑู ุฐุฑู ูุณุงุฆู ูู ูุจุงุดุฏ. ุจุฑุง ุฏุฏู ุฒูุงู ฺฉู ุตุฑู ูุฑ ุจุฎุด ุดุฏู ุงุฒ ุณูฺ time-- ุงุณุชูุงุฏู ฺฉูุฏ.\nJava - HttpOnly Cookies ูโุฎูุงูู ฺฺฉ ฺฉูู ฺฉู ุขุง ฺฉูฺฉ ูุง ุฏุงุฑุง ุฎุตูุตุช HttpOnly ุงุณุช ู ุงฺฏุฑ ูุณุช ุขู ุฑุง ุฏุฑุณุช ฺฉูู. ูู ูุงููู cookie-missing-httponly ุฌุงูุง ุฑุง ุฎูุงุตู ฺฉุฑุฏูโุงู:\n# java-httponly/httponly-practice.yaml rules: - id: cookie-missing-httponly message: Match found severity: WARNING languages: [java] patterns: - pattern-not-inside: $COOKIE.setValue(\"\"); ... - pattern-either: - pattern: $COOKIE.setHttpOnly(false); - patterns: - pattern-not-inside: $COOKIE.setHttpOnly(...); ... - pattern: $RESPONSE.addCookie($COOKIE); ุงู ูุงููู (https://semgrep.dev/s/parsiya:java-httponly-practice) ฺฺฉ ูโฺฉูุฏ ฺฉู ุขุง:\nูุง ุจู ุตูุฑุช ุฏุณุช ููุฏุงุฑ HttpOnly ุฑุง false ฺฉุฑุฏูโุงู. ุฏุฑ ุงู ุตูุฑุช ุจุงุฏ ููุฏุงุฑ false ุฑุง ุจู true ุชุบุฑ ุฏูู. ฺฉ ฺฉูฺฉ ุจู response (ูพุงุณุฎุ) ุงุถุงูู ฺฉุฑุฏูโุงู ูู HttpOnly ุฑุง ุณูุช ูฺฉุฑุฏูโุงู. ุฏุฑ ุงู ุตูุฑุช ุจุงุฏ ููุฏุงุฑ HttpOnly ุฑุง ุจู true ุชุบุฑ ุฏูู ุจุฑุง ุฑูุน ุงู ูุดฺฉู ุจุงุฏ ุงู ูุงููู ุฑุง ุจู ุงู ุฏู ุจุฎุด ุจุดฺฉุงูู ู ุฏู ูุงููู ูุฌุฒุง ุฏุฑุณุช ฺฉูู ุฒุฑุง ุจุฎุด fix ุจุฑุง ููู ููุงูู ุงุฌุฑุง ูโุดูุฏ ูู ูุง ุฏู ููุน ุชุฑูู ูุฎุชูู ุฏุงุฑู.\nุชุฑูู HttpOnly ุงูู ุฏุฑ ุงู ุชุฑูู ุชููุง ุจุงุฏ ููุฏุงุฑ false ุฏุฑ ;COOKIE.setHttpOnly(false)$ุฑุง ุจุง true ุฌุงฺฏุฒู ฺฉูู (ุจุฑุง ุชูุฑู ุงุฒ https://semgrep.dev/s/parsiya:java-httponly-practice-1 ุงุณุชูุงุฏู ฺฉูุฏ):\n# java-httponly/httponly-practice-1.yaml rules: - id: cookie-missing-httponly-1 message: Match found severity: WARNING languages: [java] patterns: - pattern-not-inside: $COOKIE.setValue(\"\"); ... - pattern: $COOKIE.setHttpOnly(false); fix: $COOKIE.setHttpOnly(true); semgrep -c httponly-practice-1.yaml httponly.java ุชุฑูู HttpOnly ุฏูู ุฏุฑ ุงู ุจุฎุด ูุง ;RESPONSE.addCookie($COOKIE)$ ุฑุง ูโุจูู ุงูุง ุฎุจุฑ ุงุฒ setHttpOnly ูุณุช.ุจุงุฏ ุขู ุฑุง ุงุถุงูู ฺฉูู. ุงู ูุงููู (https://semgrep.dev/s/parsiya:java-httponly-practice-2) ุงู ฺฉุงุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏ ุงูุง ฺฉุฏ ุงุถุงูู ุดุฏู โุฎูุดฺฏูโ ูุณุช (ุจุฑุง ุฌุงูุง ูุงุตูู ู ุบุฑู ููู ูุณุชูุฏ ู ุดุงุฏ ุดูุง ุจฺฏูุฏ ฺฉู ุงู ูุงููู ุจุฑุง ูู ฺฉุงู ุงุณุช ุฒุฑุง ุงุจุฒุงุฑูุง ุฏฺฏุฑ ุฏุงุฑุฏ ฺฉู ุงุชููุงุชฺฉ ฺฉูุฏ ุดูุง ุฑุง ููุฑููุช ูโโฺฉููุฏ).\nฺฉูุฏู ุฒุดุช ูุง ูโุชูุงูู ุงู ูุดฺฉู ุฑุง ุจุง ูุฑูุงู fix-regex ุญู ฺฉูู.\nูุฑูุงู fix-regex ููุงูุทูุฑ ฺฉู ุฏุฏู ุจุฑุง ุฌุงุจุฌุงโูุง ุณุงุฏู (ูุซูุง ุชุบุฑ badFunc ุจู goodFunc) ูุฑูุงู fix ฺฉุงู ุงุณุช. ุงูุง fix-regex ุจู ูุง ูุฏุฑุช ูุงููุฑ ุจุดุชุฑ ูโุฏูุฏ.\nhttps://semgrep.dev/docs/experiments/overview/#autofix-with-regular-expression-replacement ุงู ูุฑูุงู ุณู ุจุฎุด ุฏุงุฑุฏ:\nุจุฎุด regex ฺฉู regular expression (ูุงุฑุณุด ูุงูุนุง ฺ ูุดูุ ุงุตูุงู ูุนุงุฏู ุฏุงุฑูุ) ุฑุง ุฑู ุจุฎุด ุงุฒ ฺฉุฏ ฺฉู ุชูุณุท ูุงููู ูพุฏุง ุดุฏู ุงุณุชุ ุงุฌุฑุง ูโฺฉูุฏ. ุจุฎุด replacement: ฺุฒ ฺฉู ุจุงุฏ ุจุง ุจุฎุด ุจุงูุง ุฌุงฺฏุฒู ุดูุฏ. ุจุฎุด count: ุชุนุฏุงุฏ ุฌุงฺฏุฒูโูุง. ูฺฉุชู: ุฏุฑ ุญุงู ุญุงุถุฑ (ุขูุฑู 2022) Semgrep ุงุฒ metavariable ุฏุฑ fix-regex ูพุดุชุจุงู ููโฺฉูุฏ.\nุจุง ุงุณุชูุงุฏู ุงุฒ fix-regex ูโุชูุงูู ูุงููู ูุจู ุฑุง ุฏูุจุงุฑู ุจููุณู. ุจุฑุง ุงู ฺฉุงุฑ ุงูู ุจุงุฏ ุจุจูู ฺฉู ฺู ฺุฒ capture ูโุดูุฏ. ุงู ูุงููู ุฑุง ูโุชูุงูุฏ ุฏุฑ https://semgrep.dev/s/parsiya:java-httponly-fix-regex-practice ุงุฌุฑุง ฺฉูุฏ.\n# java-httponly/httponly-fix-regex-practice.yaml rules: - id: cookie-missing-httponly-fix-regex-practice message: Match found severity: WARNING languages: - java patterns: - pattern-not-inside: $COOKIE.setValue(\"\"); ... - pattern-not-inside: $COOKIE.setHttpOnly(...); ... - pattern: $RESPONSE.addCookie($COOKIE); fix-regex: regex: (.*) replacement: //\\1 ูุชุฌู ุงุฌุฑุง ูุงููู ุจุงูุง ุฏุฑ ุฌูุงุจุ //ุฑุง ุฏู ุจุงุฑ ูโุจูู. ฺูู regex ูุง greedy (ุญุฑุต) ุงุณุช. ุจุฑุง ุงู ฺฉุงุฑ ุจุงุฏ ุงุฒ ููุฏ count ุจุง ููุฏุงุฑ ฺฉ ุงุณุชูุงุฏู ฺฉูู ฺฉู ููุท ุงููู ุฌุงฺฏุฒู ุงูุฌุงู ุดูุฏ.\nุงุฌุฑุง ูุงููู ุจุง count ุจุฑุงุจุฑ ฺฉ ูู ูููุฒ ฺฉูุฏู ุฎูุดฺฏู ูุฏุงุฑู. ุจุฑุง ุงู ฺฉุงุฑ ุฏุฑ ุจุฎุด regex ุจุงุฏ ูุงุตูู ุจู ุงุจุชุฏุง ุฎุท ุชุง ุงูู ฺฉูุฏ ุฑุง capture ฺฉูู. ุจุนุฏ ุฏุฑ ุจุฎุด replacement ุงูู ูุงุตูู ุฑุง ุฌุงฺฏุฒู ฺฉูู (1\\) ู ุจุนุฏ // ู ุฏุฑ ุงูุชูุง ุฎูุฏ ฺฉูุฏ (2\\).\nfix-regex: regex: (\\s*)(.*) replacement: \\1// \\2 count: 1 ุญุงูุง ุจุงุฏ ุฏุฑ ุฎุท ุฌุฏุฏุ ฺฉูุฏู ุฏุฑุณุช ุฑุง ูุงุฑุฏ ฺฉูู. ุงฺฏุฑ ูโุชูุงูุณุชู ุงุฒ metavariable ูุง ุงุณุชูุงุฏู ฺฉูู ฺฉุงุฑ ูุง ุฎู ุฑุงุญุชโุชุฑ ุจูุฏ ุงูุง ุชุฑูู ูพุงู ุฏุฑุณุช ุงุฌุฑุง ููโุดูุฏ. ุงู ุฑุง ุฏุฑ https://semgrep.dev/s/parsiya:java-httponly-fix-regex-practice-2 ูโุชูุงูุฏ ุงูุชุญุงู ฺฉูุฏ.\n# java-httponly/httponly-fix-regex-practice-2.yaml fix-regex: regex: (\\s*)(.*) replacement: | \\1$COOKIE.setHttpOnly(true); \\1\\2 count: 1 ููุฏุงุฑ COOKIE$ ุฏุฑ ุชุฑูู ุฌุงฺฏุฒู ูุดุฏู ุงุณุช ุจุฑุง ุงู ฺฉุงุฑ ุจุงุฏ ุงุฒ ูุงููู ุฒุฑ ุงุณุชูุงุฏู ฺฉูู (ูุงูุนุง ุญูุตูู ุชูุถุญ ุฏูุจุงุฑู ุขู ุฑุง ูุฏุงุฑู ๐):\n# java-httponly/httponly-fix-regex-practice-final.yaml rules: - id: cookie-missing-httponly-fix-regex-practice-final message: Match found severity: WARNING languages: - java patterns: - pattern-not-inside: $COOKIE.setValue(\"\"); ... - pattern-not-inside: $COOKIE.setHttpOnly(...); ... - pattern: $RESPONSE.addCookie($COOKIE); fix-regex: regex: (\\s*)(.*addCookie\\((.*)\\).*) replacement: | \\1\\3.setHttpOnly(true); \\1\\2 count: 1 ุจูู ุจูุงฺฏ ุฏฺฏุฑ ฺุฒ ุฌุฏุฏ ุจู ุดูุง ุงุฏ ููโโุฏูุฏ. ุงูุง ูโุชูุงูุฏ ุฏุฑ ุจูุงฺฏ ุงูฺฏูุณ ุจุฎูุงูุฏ.\nฺู ุงุฏ ฺฏุฑูุชูุ ูุงุจูุช ุชุฑูู ุฎูุฏฺฉุงุฑ Semgrep ุจุณุงุฑ ุฌุงูุจ ุงุณุช. ูู ุงุฒ ุขู ุจุฑุง ุงุถุงูู ฺฉุฑุฏู comment ุจู ฺฉุฏ ุงุณุชูุงุฏู ูโฺฉูู ุชุง ููฺฏุงู ูุฑูุฑ ุขู ุจุฏุงูู ูุฑ ุจุฎุด ฺู ูุดฺฉู ุฏุงุฑุฏ.\n","wordCount":"1401","inLanguage":"fa","datePublished":"2022-04-23T11:40:33-07:00","dateModified":"2022-04-23T11:40:33-07:00","author":{"@type":"Person","name":"ูพุงุฑุณุง"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://parsiya.github.io/parsiya.fa/post/2022/semgrep-autofix/"},"publisher":{"@type":"Organization","name":"ุงููุช ู ุบุฑู ุจู ูุงุฑุณ","logo":{"@type":"ImageObject","url":"https://parsiya.github.io/parsiya.fa/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://parsiya.github.io/parsiya.fa/ accesskey=h title="ุงููุช ู ุบุฑู ุจู ูุงุฑุณ (Alt + H)">ุงููุช ู ุบุฑู ุจู ูุงุฑุณ</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://parsiya.github.io/parsiya.fa/>Home</a>&nbsp;ยป&nbsp;<a href=https://parsiya.github.io/parsiya.fa/post/>Posts</a></div><h1 class=post-title>ูุงุจูุช ุชุฑูู ุฎูุฏฺฉุงุฑ Semgrep</h1><div class=post-meta>April 23, 2022&nbsp;ยท&nbsp;ูพุงุฑุณุง</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>ููุฑุณุช ูุทุงูุจ</div></summary><div class=inner><ul><li><a href=#%d9%be%db%8c%d8%b4%d9%86%db%8c%d8%a7%d8%b2%d9%87%d8%a7%db%8c-%d8%a7%db%8c%d9%86-%d8%a8%d9%84%d8%a7%da%af aria-label="ูพุดโูุงุฒูุง ุงู ุจูุงฺฏ">ูพุดโูุงุฒูุง ุงู ุจูุงฺฏ</a></li><li><a href=#%d8%a7%d8%ac%d8%b1%d8%a7%db%8c-%d9%82%d9%88%d8%a7%d9%86%db%8c%d9%86 aria-label="ุงุฌุฑุง ููุงูู">ุงุฌุฑุง ููุงูู</a></li><li><a href=#%d8%b1%d9%88%d8%b4%d9%87%d8%a7%db%8c-%d8%a7%d8%b3%d8%aa%d9%81%d8%a7%d8%af%d9%87-%d8%a7%d8%b2-autofix aria-label="ุฑูุดโูุง ุงุณุชูุงุฏู ุงุฒ autofix">ุฑูุดโูุง ุงุณุชูุงุฏู ุงุฒ autofix</a><ul><li><a href=#%d9%81%d8%b1%d9%85%d8%a7%d9%86-fix aria-label="ูุฑูุงู Fix">ูุฑูุงู Fix</a><ul><li><a href=#python---sysexit aria-label="Python - sys.exit">Python - sys.exit</a></li><li><a href=#java---cbc-padding-oracle aria-label="Java - CBC Padding Oracle">Java - CBC Padding Oracle</a></li><li><a href=#java---httponly-cookies aria-label="Java - HttpOnly Cookies">Java - HttpOnly Cookies</a><ul><li><a href=#%d8%aa%d8%b1%d9%85%db%8c%d9%85-httponly-%d8%a7%d9%88%d9%84 aria-label="ุชุฑูู HttpOnly ุงูู">ุชุฑูู HttpOnly ุงูู</a></li><li><a href=#%d8%aa%d8%b1%d9%85%db%8c%d9%85-httponly-%d8%af%d9%88%d9%85 aria-label="ุชุฑูู HttpOnly ุฏูู">ุชุฑูู HttpOnly ุฏูู</a></li></ul></li></ul></li><li><a href=#%d9%81%d8%b1%d9%85%d8%a7%d9%86-fix-regex aria-label="ูุฑูุงู fix-regex">ูุฑูุงู fix-regex</a></li></ul></li><li><a href=#%da%86%d9%87-%db%8c%d8%a7%d8%af-%da%af%d8%b1%d9%81%d8%aa%d9%85 aria-label="ฺู ุงุฏ ฺฏุฑูุชูุ">ฺู ุงุฏ ฺฏุฑูุชูุ</a></li></ul></div></details></div><div class=post-content><p>ุฏุฑ ุงู ููุดุชุงุฑ ูโุฎูุงูู ุฏุฑ ููุฑุฏ ูุงุจูุช ุชุฑููู ุฎูุฏฺฉุงุฑ (<a href=https://semgrep.dev/docs/experiments/overview/#autofix>autofix</a>) ฺฉูุฏ Semgrep ุตุญุจุช ฺฉูู. ุงู ูุงุจูุช ุขุฒูุงุด ุจู ูุง ุงูฺฉุงู ูโุฏูุฏ ฺฉู ุจุนุฏ ุงุฒ ุงูุชู ูุชุงุฌ ุฏุฑ ูุงููุง ููุจุนุ ุขููุง ุฑุง ุจู ุตูุฑุช ุงุชููุงุชฺฉ ุฏุณุชฺฉุงุฑ ฺฉูู.</p><p>ุงฺฏุฑ ุนูุงูู ุจู ุฎูุงูุฏู ูุณุฎู ุงูฺฏูุณ ุฏุงุฑุฏ:</p><ul><li><a href=https://parsiya.net/blog/2021-10-25-a-hands-on-intro-to-semgreps-autofix/>https://parsiya.net/blog/2021-10-25-a-hands-on-intro-to-semgreps-autofix/</a></li></ul><p>ููู ูููููโูุง ุฏุฑ Semgrep playground ูุณุชูุฏ ูู ูโุชูุงูุฏ ุขููุง ุฑุง ุขููุงู ูุฒ ุงุฌุฑุง ฺฉูุฏ:</p><ul><li><a href=https://github.com/parsiya/Parsia-Code/tree/master/semgrep-autofix>https://github.com/parsiya/Parsia-Code/tree/master/semgrep-autofix</a></li></ul><h1 id=ูพุดูุงุฒูุง-ุงู-ุจูุงฺฏ>ูพุดโูุงุฒูุง ุงู ุจูุงฺฏ<a hidden class=anchor aria-hidden=true href=#ูพุดูุงุฒูุง-ุงู-ุจูุงฺฏ>#</a></h1><p>ุจุฑุง ุงุณุชูุงุฏู ุจููู ุงุฒ ุงู ุจูุงฺฏุ ุจูุชุฑ ุงุณุช ุงู ููุงุฑุฏ ุฑุง ุจุฏุงูุฏ:</p><ul><li>ุงุณุชูุงุฏู ุงุฒ Semgrep ู ููุดุชู rule (ูุงูููุ). <a href=/parsiya.fa/post/2021/semgrep-1/>ฺุฑุง ุงุฒ Semgrep ุจุฑุง Static Analysis ุงุณุชูุงุฏู ฺฉููุ</a> ุฑุง ุจุฎูุงูุฏ.</li><li>ุขุดูุง ุณูุฑุณูุฑ ุจุง ุฎูุงูุฏู ฺฉุฏู Javaุ Python ู Go.</li><li>ุขุดูุง ูุฎุชุตุฑ ุจุง ุจุนุถ ููุงูู ุงููุช ูุงููุฏ HttpOnly ู XSS.</li></ul><p>ูฺฉุชู: ุชุฑููู ุฎูุฏฺฉุงุฑุ ฺฉ ุงุฒ <a href=https://semgrep.dev/docs/experiments/overview/>ูุงุจูุชโูุง ุขุฒูุงุด Semgrep</a> ุงุณุช. ุฏุฑ ุฒูุงู ูฺฏุงุฑุด (ุขูุฑู 2022 ุจุฑุง ูุณุฎู ูุงุฑุณ ู ุงฺฉุชุจุฑ 2021 ุจุฑุง ูุณุฎู ุงูฺฏูุณ) ููู ูุซุงูโูุง ุฏุฑุณุช ูุณุชูุฏ. ุงฺฏุฑ ุงุฒ ุขูุฏู ูุงุฏุ ุดุงุฏ ุจุนุถ ฺุฒูุง ูุชูุงูุช ุจุงุดูุฏ.</p><h1 id=ุงุฌุฑุง-ููุงูู>ุงุฌุฑุง ููุงูู<a hidden class=anchor aria-hidden=true href=#ุงุฌุฑุง-ููุงูู>#</a></h1><p>ุจุฑุง ุงุฌุฑุง ู ุชุณุช ููุงูู ุฏู ุฑุงู ุฏุงุฑู:</p><ol><li>ุงุณุชูุงุฏู ุงุฒ Semgrep playground ุฏุฑ ุขุฏุฑุณ <a href=https://semgrep.dev/playground>https://semgrep.dev/playground</a>. ูู ุจุดุชุฑ ุงุฒ ุงู ุฑูุด ุงุณุชูุงุฏู ูโฺฉูู ฺูู ุฑุงุญุช ู ุณุฑุน ูโโุชูุงูู ูุงููู ุฑุง ุนูุถ ฺฉูู ู ูุชุฌู ุฑุง ุจุจูู.</li><li>ุงุฌุฑุง ุฏุฑ ุฎุทู ูุฑูุงู (ุชุฑุฌูู ูุงุฑุณ command line).</li></ol><p>ุจุนุฏ ุงุฒ ููุดุชู ฺฉ ูุงููู ูโุชูุงูุฏ ุฏุฑุณุช ุณุงุฎุชุงุฑ ูุงู yaml ุขู ุฑุง ุชุณุช ฺฉูุฏ:</p><pre tabindex=0><code>semgrep-crule1.yaml--validate 
</code></pre><p>ุงฺฏุฑ ฺฉ ูุงููู ุฏุงุฑุง ุจุฎุด autofix ุจุงุดุฏุ ููฺฏุงู ุงุฌุฑุง ูุงู ุงุตู ุฏุณุชฺฉุงุฑ ููโุดูุฏ ูู ูโุชูุงูุฏ ุชุบุฑุงุช ุฑุง ุจุจูุฏ. ุจุฑุง ุชุบุฑ ูุงู ุงุตู ุงุฒ ุณูฺ <code>autofix--</code> ุงุณุชูุงุฏู ฺฉูุฏ. ุจุฑุง ูุดุงูุฏู ุชุบุฑุงุช ุจุฏูู ุชุบุฑ ูุงู ุงุตู ุงุฒ ุณูฺ <code>dry-run--</code> ุงุณุชูุงุฏู ฺฉูุฏ (ุญุถูุฑ ููุฒูุงู autofix ู dry-run ูุนุงุฏู ูุจูุฏู autofix ุงุณุช ุนู ุชุบุฑุงุช ููุท ูุดุงู ุฏุงุฏู ูโุดููุฏ):</p><pre tabindex=0><code>semgrep -c rule1.yaml example.java --autofix --dryrun 
</code></pre><figure><img loading=lazy src=00-autofix-dryrun.png><figcaption>ุงุณุชูุงุฏู ุงุฒ ุณูฺโูุง ูุฎุชูู</figcaption></figure><h1 id=ุฑูุดูุง-ุงุณุชูุงุฏู-ุงุฒ-autofix>ุฑูุดโูุง ุงุณุชูุงุฏู ุงุฒ autofix<a hidden class=anchor aria-hidden=true href=#ุฑูุดูุง-ุงุณุชูุงุฏู-ุงุฒ-autofix>#</a></h1><p>ุฏู ุฑูุด ูุฎุชูู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ autofix ุฏุงุฑู:</p><ol><li>fix</li><li>fix-regex</li></ol><h2 id=ูุฑูุงู-fix>ูุฑูุงู Fix<a hidden class=anchor aria-hidden=true href=#ูุฑูุงู-fix>#</a></h2><p>ูุฑ ฺุฒ ฺฉู ูุงููู ูพุฏุง ฺฉุฑุฏู ุงุณุช ุฑุง ุจุง ููุฏุงุฑ ุงู ูุฑูุงู ุฌุงฺฏุฒู ูฺฉูู. ุจูุชุฑู ฺฉุงูุฏุฏูุง ุจุฑุง ุงู ูุงุจูุชุ ุชูุงุจุน ุง ุฑุดุชู (string) ูุง ูุงุงูู ูุณุชูุฏ ฺฉู ุจุงุฏ ุจุง ูุนุงุฏู ุงูู ุฌุงฺฏุฒู ุดููุฏ. ฺูุฏ ูุซุงู ุจุง ุงู ุฏุณุชูุฑ ุจุจูู.</p><h3 id=python---sysexit>Python - sys.exit<a hidden class=anchor aria-hidden=true href=#python---sysexit>#</a></h3><p>ุงู ูุซุงู ุฑุง ุงุฒ ุขููุฒุด Semgrep ุฏุฑ ุขุฏุฑุณ (<a href=https://semgrep.dev/s/R6g>https://semgrep.dev/s/R6g</a>) ูุฑุถ ฺฏุฑูุชูโุงู. ุฏุฑ ุงู ูุงููู ูุง ุจู ุฏูุจุงู ุชุงุจุน exit ูุณุชู ู ูโุฎูุงูู ุขู ุฑุง ุจุง sys.exit ุฌุงฺฏุฒู ฺฉูู. Semgrep ุชูุงูุช ุชุงุจุน exit ุจุง ุฏฺฏุฑ ุงุณุชูุงุฏูโูุง ุงู ฺฉููู ุฑุง ุฏุฑ ฺฉูุฏ ูโูููุฏ ู ูโโุชูุงูุฏ ุฑุงุญุช ุขู ุฑุง ุฌุงฺฏุฒู ฺฉูุฏ. ุจุนุฏ ุงุฒ ุงุฌุฑุง ูุงููู ุฏุฑ ูุจโุณุงุช ุจุงูุง ู ุจูุฏ ฺฉู ุฏฺฉูู Apply Fix ูุนุงู ุดุฏู ู ูโุชูุงูุฏ ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ฺฉุฏ ุจุฑูุงูู ุฑุง ุฏุณุชฺฉุงุฑ ฺฉูุฏ.</p><figure><img loading=lazy src=01-sys-exit.png><figcaption>ุชุบุฑ ุงุชููุงุชฺฉ exit ุจู sys.exit</figcaption></figure><p>ฺฉ ุงุฒ ูฺฉุงุช ุฌุงูุจ ุงู ุงุณุช ฺฉู ูโุชูุงูู ูพุงุฑุงูุชุฑ ุชุงุจุน ุฑุง ุชูุณุท ฺฉ metavariable (ุฏุฑ ุงูุฌุง ุจุง ูุงู X) ุฏุฑ ูุงููู ุฐุฎุฑู ฺฉูู ู ุฏุฑ autofix ุงุณุชูุงุฏู ฺฉูู. ุฏฺฏุฑ ูุงุฒู ูุณุช ุญุช ูฺฏุฑุงู ููุฏุงุฑ ูพุงุฑุงูุชุฑ ุจุงุดู.</p><h3 id=java---cbc-padding-oracle>Java - CBC Padding Oracle<a hidden class=anchor aria-hidden=true href=#java---cbc-padding-oracle>#</a></h3><p>ุจุฑุง ุงู ูุซุงูุ ูุงููู cbc-padding-oracle ุฒุจุงู ุฌุงูุง ุฑุง ุงุฒ ุฑุฌุณุชุฑ Semgrep ุฏุณุชฺฉุงุฑ ฺฉุฑุฏูโุงู ุชุง ุฑุงุญุชโุชุฑ ุฎูุงูุฏู ุดูุฏ.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># java-cbc-padding-oracle/cbc-padding-oracle.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>cbc-padding-oracle</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>severity</span>: <span style=color:#ae81ff>WARNING</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>message</span>: <span style=color:#ae81ff>Match found</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>languages</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>java</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>pattern</span>: <span style=color:#ae81ff>$CIPHER.getInstance(&#34;=~/.*\/CBC\/PKCS5Padding/&#34;)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fix</span>: <span style=color:#ae81ff>$CIPHER.getInstance(&#34;AES/GCM/NoPadding&#34;)</span>
</span></span></code></pre></div><p>ุงู ูุงููู ุจู ุฏูุจุงู ูุฑ ฺุฒ ฺฉู ุดุจู <code>object.getInstance("string")</code> ุจุงุดุฏ ูโฺฏุฑุฏุฏ ู ุฏุฑ ุตูุฑุช ฺฉู ุฑุดุชู ุฏุงุฎู ุดุงูู <code>CBC/PKCS5Padding</code> ุจุงุดุฏุ ูุชุฌู ุฑุง ฺฏุฒุงุฑุด ูโุฏูุฏ. ุงู ูุงููู ุงุฒ ูุงุจูุช ูุฏู <a href=https://semgrep.dev/docs/writing-rules/pattern-syntax/#string-matching>string matching</a> ุงุณุชูุงุฏู ูโฺฉูุฏ ฺฉู ุฏฺฏุฑ ูพุดุชุจุงู ููโุดูุฏ. ุจุฑุง ุฏุณุชโฺฏุฑู ุจุงุฏ ุขู ุฑุง ุจุง <a href=https://semgrep.dev/docs/writing-rules/rule-syntax/#metavariable-regex>metavariable-regex</a> ุฌุงฺฏุฒู ฺฉูู. ุงู ฺฉุงุฑ ุณุงุฏู ุงุณุชุ ุงูู ฺฉ metavariable ุจู ุนููุงู ูพุงุฑุงูุชุฑ ุชุนุฑู ูโฺฉูู (ุฏุฑ ุงูุฌุง <code>INS$</code>) ู ุจุนุฏ regex ุฑุง ุฑู ุขู ุงุฌุฑุง ูโฺฉูู ู ูุชุฌู ููุงู ุงุณุช:</p><ul><li><a href=https://semgrep.dev/s/parsiya:java-cbc-padding-oracle-metavariable-regex>https://semgrep.dev/s/parsiya:java-cbc-padding-oracle-metavariable-regex</a></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># java-cbc-padding-oracle/cbc-padding-oracle-metavariable-regex.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>cbc-padding-oracle-metavariable-regex</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>message</span>: <span style=color:#ae81ff>Match found</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>languages</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>java</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>severity</span>: <span style=color:#ae81ff>WARNING</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>patterns</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>pattern</span>: <span style=color:#ae81ff>$CIPHER.getInstance($INS)</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>metavariable-regex</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>metavariable</span>: <span style=color:#ae81ff>$INS</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>.*\/CBC\/PKCS5Padding</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fix</span>: <span style=color:#ae81ff>$CIPHER.getInstance(&#34;AES/GCM/NoPadding&#34;)</span>
</span></span></code></pre></div><p>ููุฏุงุฑ &ldquo;ูุญุงุณุจู&rdquo; ูุงููู ุฌุฏุฏ ุฏุฑ playground ุนุฏุฏ ุจุฒุฑฺฏุชุฑ ุจูุฏ ู ูู ุฎูุงุณุชู ุขู ุฑุง ุขุฒูุงุด ฺฉูู. ูุงููู ุฌุฏุฏ ุฎู ูพฺุฏูโุชุฑ ุงุฒ ูุงููู ูุฏู ูุณุช.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>$ multitime -q -n 50 ./cbc-padding-oracle.sh</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>===&gt; multitime results</span>
</span></span><span style=display:flex><span><span style=color:#f92672>1</span>: -<span style=color:#ae81ff>q ./cbc-padding-oracle.sh</span>
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>Mean        Std.Dev.    Min         Median      Max</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>real        0.781       0.006       0.773       0.780       0.806</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>user        0.501       0.041       0.406       0.500       0.609</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>sys         0.256       0.044       0.172       0.258       0.359</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>$ multitime -q -n 50 ./cbc-padding-oracle-metavariable-regex.sh</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>===&gt; multitime results</span>
</span></span><span style=display:flex><span><span style=color:#f92672>1</span>: -<span style=color:#ae81ff>q ./cbc-padding-oracle-metavariable-regex.sh</span>
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>Mean        Std.Dev.    Min         Median      Max</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>real        0.788       0.007       0.778       0.786       0.813</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>user        0.516       0.047       0.406       0.516       0.609</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>sys         0.247       0.048       0.156       0.250       0.359</span>
</span></span></code></pre></div><p>ุงู ููุฏุงุฑ ูุญุงุณุจู ู ุนุฏุฏ ฺฉู ุฏุฑ playground ูุดุงู ุฏุงุฏู ูโุดูุฏ ุจุญุซ ุงุณุช ฺฉู ุจุนุฏุง ุจุงุฏ ุจู ุขู ุจูพุฑุฏุงุฒู. ุฎูุงุตู ุจฺฏูุ ูุนูููุงู ูุจุงุฏ ูฺฏุฑุงู ุนููฺฉุฑุฏ ูุงููู ุฎูุฏ ุจุงุดุฏ. ููุฏุงุฑ ุฒุงุฏ ุงุฒ ููุช Semgrep ุตุฑู ุฎูุงูุฏู ู ูพุฑุฏุงุฒุด ูุงูโูุง ู ุณูพุณ ุฏุฑุณุช ฺฉุฑุฏู Abstract Syntax Tree (AST) ฺฉูุฏ ูโุดูุฏ. ุฎู regex ูุง ูพฺุฏู ูููุณุฏ ุงูุง ุฏฺฏุฑ ูฺฏุฑุงู ุฐุฑู ุฐุฑู ูุณุงุฆู ูู ูุจุงุดุฏ. ุจุฑุง ุฏุฏู ุฒูุงู ฺฉู ุตุฑู ูุฑ ุจุฎุด ุดุฏู ุงุฒ ุณูฺ <code>time--</code> ุงุณุชูุงุฏู ฺฉูุฏ.</p><h3 id=java---httponly-cookies>Java - HttpOnly Cookies<a hidden class=anchor aria-hidden=true href=#java---httponly-cookies>#</a></h3><p>ูโุฎูุงูู ฺฺฉ ฺฉูู ฺฉู ุขุง ฺฉูฺฉ ูุง ุฏุงุฑุง ุฎุตูุตุช <code>HttpOnly</code> ุงุณุช ู ุงฺฏุฑ ูุณุช ุขู ุฑุง ุฏุฑุณุช ฺฉูู. ูู ูุงููู <a href=https://github.com/returntocorp/semgrep-rules/blob/develop/java/lang/security/audit/cookie-missing-httponly.yaml>cookie-missing-httponly</a> ุฌุงูุง ุฑุง ุฎูุงุตู ฺฉุฑุฏูโุงู:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># java-httponly/httponly-practice.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>- <span style=color:#f92672>id</span>: <span style=color:#ae81ff>cookie-missing-httponly</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>message</span>: <span style=color:#ae81ff>Match found</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>severity</span>: <span style=color:#ae81ff>WARNING</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>languages</span>: [<span style=color:#ae81ff>java]</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>patterns</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>pattern-not-inside</span>: <span style=color:#ae81ff>$COOKIE.setValue(&#34;&#34;); ...</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>pattern-either</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>pattern</span>: <span style=color:#ae81ff>$COOKIE.setHttpOnly(false);</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>patterns</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>pattern-not-inside</span>: <span style=color:#ae81ff>$COOKIE.setHttpOnly(...); ...</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>pattern</span>: <span style=color:#ae81ff>$RESPONSE.addCookie($COOKIE);</span>
</span></span></code></pre></div><p>ุงู ูุงููู (<a href=https://semgrep.dev/s/parsiya:java-httponly-practice>https://semgrep.dev/s/parsiya:java-httponly-practice</a>) ฺฺฉ ูโฺฉูุฏ ฺฉู ุขุง:</p><ol><li>ูุง ุจู ุตูุฑุช ุฏุณุช ููุฏุงุฑ HttpOnly ุฑุง false ฺฉุฑุฏูโุงู. ุฏุฑ ุงู ุตูุฑุช ุจุงุฏ ููุฏุงุฑ false ุฑุง ุจู true ุชุบุฑ ุฏูู.</li><li>ฺฉ ฺฉูฺฉ ุจู response (ูพุงุณุฎุ) ุงุถุงูู ฺฉุฑุฏูโุงู ูู HttpOnly ุฑุง ุณูุช ูฺฉุฑุฏูโุงู. ุฏุฑ ุงู ุตูุฑุช ุจุงุฏ ููุฏุงุฑ HttpOnly ุฑุง ุจู true ุชุบุฑ ุฏูู</li></ol><p>ุจุฑุง ุฑูุน ุงู ูุดฺฉู ุจุงุฏ ุงู ูุงููู ุฑุง ุจู ุงู ุฏู ุจุฎุด ุจุดฺฉุงูู ู ุฏู ูุงููู ูุฌุฒุง ุฏุฑุณุช ฺฉูู ุฒุฑุง ุจุฎุด fix ุจุฑุง ููู ููุงูู ุงุฌุฑุง ูโุดูุฏ ูู ูุง ุฏู ููุน ุชุฑูู ูุฎุชูู ุฏุงุฑู.</p><h4 id=ุชุฑูู-httponly-ุงูู>ุชุฑูู HttpOnly ุงูู<a hidden class=anchor aria-hidden=true href=#ุชุฑูู-httponly-ุงูู>#</a></h4><p>ุฏุฑ ุงู ุชุฑูู ุชููุง ุจุงุฏ ููุฏุงุฑ false ุฏุฑ ;COOKIE.setHttpOnly(false)$ุฑุง ุจุง true ุฌุงฺฏุฒู ฺฉูู (ุจุฑุง ุชูุฑู ุงุฒ <a href=https://semgrep.dev/s/parsiya:java-httponly-practice-1>https://semgrep.dev/s/parsiya:java-httponly-practice-1</a> ุงุณุชูุงุฏู ฺฉูุฏ):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># java-httponly/httponly-practice-1.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>- <span style=color:#f92672>id</span>: <span style=color:#ae81ff>cookie-missing-httponly-1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>message</span>: <span style=color:#ae81ff>Match found</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>severity</span>: <span style=color:#ae81ff>WARNING</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>languages</span>: [<span style=color:#ae81ff>java]</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>patterns</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>pattern-not-inside</span>: <span style=color:#ae81ff>$COOKIE.setValue(&#34;&#34;); ...</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>pattern</span>: <span style=color:#ae81ff>$COOKIE.setHttpOnly(false);</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>fix</span>: <span style=color:#ae81ff>$COOKIE.setHttpOnly(true);</span>
</span></span></code></pre></div><figure><img loading=lazy src=02-httponly-1.png><figcaption>semgrep -c httponly-practice-1.yaml httponly.java</figcaption></figure><h4 id=ุชุฑูู-httponly-ุฏูู>ุชุฑูู HttpOnly ุฏูู<a hidden class=anchor aria-hidden=true href=#ุชุฑูู-httponly-ุฏูู>#</a></h4><p>ุฏุฑ ุงู ุจุฎุด ูุง <code>;RESPONSE.addCookie($COOKIE)$</code> ุฑุง ูโุจูู ุงูุง ุฎุจุฑ ุงุฒ <code>setHttpOnly</code> ูุณุช.ุจุงุฏ ุขู ุฑุง ุงุถุงูู ฺฉูู. ุงู ูุงููู (<a href=https://semgrep.dev/s/parsiya:java-httponly-practice-2>https://semgrep.dev/s/parsiya:java-httponly-practice-2</a>) ุงู ฺฉุงุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏ ุงูุง ฺฉุฏ ุงุถุงูู ุดุฏู &ldquo;ุฎูุดฺฏู&rdquo; ูุณุช (ุจุฑุง ุฌุงูุง ูุงุตูู ู ุบุฑู ููู ูุณุชูุฏ ู ุดุงุฏ ุดูุง ุจฺฏูุฏ ฺฉู ุงู ูุงููู ุจุฑุง ูู ฺฉุงู ุงุณุช ุฒุฑุง ุงุจุฒุงุฑูุง ุฏฺฏุฑ ุฏุงุฑุฏ ฺฉู ุงุชููุงุชฺฉ ฺฉูุฏ ุดูุง ุฑุง ููุฑููุช ูโโฺฉููุฏ).</p><figure><img loading=lazy src=03-httponly-2.png><figcaption>ฺฉูุฏู ุฒุดุช</figcaption></figure><p>ูุง ูโุชูุงูู ุงู ูุดฺฉู ุฑุง ุจุง ูุฑูุงู <code>fix-regex</code> ุญู ฺฉูู.</p><h2 id=ูุฑูุงู-fix-regex>ูุฑูุงู fix-regex<a hidden class=anchor aria-hidden=true href=#ูุฑูุงู-fix-regex>#</a></h2><p>ููุงูุทูุฑ ฺฉู ุฏุฏู ุจุฑุง ุฌุงุจุฌุงโูุง ุณุงุฏู (ูุซูุง ุชุบุฑ <code>badFunc</code> ุจู <code>goodFunc</code>) ูุฑูุงู fix ฺฉุงู ุงุณุช. ุงูุง fix-regex ุจู ูุง ูุฏุฑุช ูุงููุฑ ุจุดุชุฑ ูโุฏูุฏ.</p><ul><li><a href=https://semgrep.dev/docs/experiments/overview/#autofix-with-regular-expression-replacement>https://semgrep.dev/docs/experiments/overview/#autofix-with-regular-expression-replacement</a></li></ul><p>ุงู ูุฑูุงู ุณู ุจุฎุด ุฏุงุฑุฏ:</p><ol><li>ุจุฎุด regex ฺฉู regular expression (ูุงุฑุณุด ูุงูุนุง ฺ ูุดูุ ุงุตูุงู ูุนุงุฏู ุฏุงุฑูุ) ุฑุง ุฑู ุจุฎุด ุงุฒ ฺฉุฏ ฺฉู ุชูุณุท ูุงููู ูพุฏุง ุดุฏู ุงุณุชุ ุงุฌุฑุง ูโฺฉูุฏ.</li><li>ุจุฎุด replacement: ฺุฒ ฺฉู ุจุงุฏ ุจุง ุจุฎุด ุจุงูุง ุฌุงฺฏุฒู ุดูุฏ.</li><li>ุจุฎุด count: ุชุนุฏุงุฏ ุฌุงฺฏุฒูโูุง.</li></ol><p><em>ูฺฉุชู: ุฏุฑ ุญุงู ุญุงุถุฑ (ุขูุฑู 2022) Semgrep ุงุฒ metavariable ุฏุฑ fix-regex ูพุดุชุจุงู ููโฺฉูุฏ.</em></p><p>ุจุง ุงุณุชูุงุฏู ุงุฒ fix-regex ูโุชูุงูู ูุงููู ูุจู ุฑุง ุฏูุจุงุฑู ุจููุณู. ุจุฑุง ุงู ฺฉุงุฑ ุงูู ุจุงุฏ ุจุจูู ฺฉู ฺู ฺุฒ capture ูโุดูุฏ. ุงู ูุงููู ุฑุง ูโุชูุงูุฏ ุฏุฑ <a href=https://semgrep.dev/s/parsiya:java-httponly-fix-regex-practice>https://semgrep.dev/s/parsiya:java-httponly-fix-regex-practice</a> ุงุฌุฑุง ฺฉูุฏ.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># java-httponly/httponly-fix-regex-practice.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>cookie-missing-httponly-fix-regex-practice</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>message</span>: <span style=color:#ae81ff>Match found</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>severity</span>: <span style=color:#ae81ff>WARNING</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>languages</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>java</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>patterns</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>pattern-not-inside</span>: <span style=color:#ae81ff>$COOKIE.setValue(&#34;&#34;); ...</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>pattern-not-inside</span>: <span style=color:#ae81ff>$COOKIE.setHttpOnly(...); ...</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>pattern</span>: <span style=color:#ae81ff>$RESPONSE.addCookie($COOKIE);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fix-regex</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>(.*)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>replacement</span>: <span style=color:#ae81ff>//\1</span>
</span></span></code></pre></div><figure><img loading=lazy src=04-httponly-fix-regex-1.png><figcaption>ูุชุฌู ุงุฌุฑุง ูุงููู ุจุงูุง</figcaption></figure><p>ุฏุฑ ุฌูุงุจุ <code>//</code>ุฑุง ุฏู ุจุงุฑ ูโุจูู. ฺูู regex ูุง greedy (ุญุฑุต) ุงุณุช. ุจุฑุง ุงู ฺฉุงุฑ ุจุงุฏ ุงุฒ ููุฏ <code>count</code> ุจุง ููุฏุงุฑ ฺฉ ุงุณุชูุงุฏู ฺฉูู ฺฉู ููุท ุงููู ุฌุงฺฏุฒู ุงูุฌุงู ุดูุฏ.</p><figure><img loading=lazy src=05-httponly-fix-regex-2.png><figcaption>ุงุฌุฑุง ูุงููู ุจุง count ุจุฑุงุจุฑ ฺฉ</figcaption></figure><p>ูู ูููุฒ ฺฉูุฏู ุฎูุดฺฏู ูุฏุงุฑู. ุจุฑุง ุงู ฺฉุงุฑ ุฏุฑ ุจุฎุด regex ุจุงุฏ ูุงุตูู ุจู ุงุจุชุฏุง ุฎุท ุชุง ุงูู ฺฉูุฏ ุฑุง capture ฺฉูู. ุจุนุฏ ุฏุฑ ุจุฎุด replacement ุงูู ูุงุตูู ุฑุง ุฌุงฺฏุฒู ฺฉูู (<code>1\</code>) ู ุจุนุฏ <code>//</code> ู ุฏุฑ ุงูุชูุง ุฎูุฏ ฺฉูุฏ (<code>2\</code>).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>    <span style=color:#f92672>fix-regex</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>(\s*)(.*)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>replacement</span>: <span style=color:#ae81ff>\1// \2</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>count</span>: <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><figure><img loading=lazy src=06-httponly-fix-regex-3.png></figure><p>ุญุงูุง ุจุงุฏ ุฏุฑ ุฎุท ุฌุฏุฏุ ฺฉูุฏู ุฏุฑุณุช ุฑุง ูุงุฑุฏ ฺฉูู. ุงฺฏุฑ ูโุชูุงูุณุชู ุงุฒ metavariable ูุง ุงุณุชูุงุฏู ฺฉูู ฺฉุงุฑ ูุง ุฎู ุฑุงุญุชโุชุฑ ุจูุฏ ุงูุง ุชุฑูู ูพุงู ุฏุฑุณุช ุงุฌุฑุง ููโุดูุฏ. ุงู ุฑุง ุฏุฑ <a href=https://semgrep.dev/s/parsiya:java-httponly-fix-regex-practice-2>https://semgrep.dev/s/parsiya:java-httponly-fix-regex-practice-2</a> ูโุชูุงูุฏ ุงูุชุญุงู ฺฉูุฏ.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># java-httponly/httponly-fix-regex-practice-2.yaml</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fix-regex</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>(\s*)(.*)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>replacement</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        \1$COOKIE.setHttpOnly(true);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        \1\2</span>        
</span></span><span style=display:flex><span>      <span style=color:#f92672>count</span>: <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><figure><img loading=lazy src=07-httponly-fix-regex-4.png><figcaption>ููุฏุงุฑ COOKIE$ ุฏุฑ ุชุฑูู ุฌุงฺฏุฒู ูุดุฏู ุงุณุช</figcaption></figure><p>ุจุฑุง ุงู ฺฉุงุฑ ุจุงุฏ ุงุฒ <a href=https://semgrep.dev/s/parsiya:java-httponly-fix-regex-practice-2>ูุงููู ุฒุฑ</a> ุงุณุชูุงุฏู ฺฉูู (ูุงูุนุง ุญูุตูู ุชูุถุญ ุฏูุจุงุฑู ุขู ุฑุง ูุฏุงุฑู ๐):</p><figure><img loading=lazy src=08-httponly-fix-regex-final.png></figure><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># java-httponly/httponly-fix-regex-practice-final.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>cookie-missing-httponly-fix-regex-practice-final</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>message</span>: <span style=color:#ae81ff>Match found</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>severity</span>: <span style=color:#ae81ff>WARNING</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>languages</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>java</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>patterns</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>pattern-not-inside</span>: <span style=color:#ae81ff>$COOKIE.setValue(&#34;&#34;); ...</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>pattern-not-inside</span>: <span style=color:#ae81ff>$COOKIE.setHttpOnly(...); ...</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>pattern</span>: <span style=color:#ae81ff>$RESPONSE.addCookie($COOKIE);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>fix-regex</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>(\s*)(.*addCookie\((.*)\).*)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>replacement</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        \1\3.setHttpOnly(true);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        \1\2</span>        
</span></span><span style=display:flex><span>      <span style=color:#f92672>count</span>: <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>ุจูู ุจูุงฺฏ ุฏฺฏุฑ ฺุฒ ุฌุฏุฏ ุจู ุดูุง ุงุฏ ููโโุฏูุฏ. ุงูุง ูโุชูุงูุฏ ุฏุฑ <a href=https://parsiya.net/blog/2021-10-25-a-hands-on-intro-to-semgreps-autofix/>ุจูุงฺฏ ุงูฺฏูุณ</a> ุจุฎูุงูุฏ.</p><h1 id=ฺู-ุงุฏ-ฺฏุฑูุชู>ฺู ุงุฏ ฺฏุฑูุชูุ<a hidden class=anchor aria-hidden=true href=#ฺู-ุงุฏ-ฺฏุฑูุชู>#</a></h1><p>ูุงุจูุช ุชุฑูู ุฎูุฏฺฉุงุฑ Semgrep ุจุณุงุฑ ุฌุงูุจ ุงุณุช. ูู ุงุฒ ุขู ุจุฑุง ุงุถุงูู ฺฉุฑุฏู comment ุจู ฺฉุฏ ุงุณุชูุงุฏู ูโฺฉูู ุชุง ููฺฏุงู ูุฑูุฑ ุขู ุจุฏุงูู ูุฑ ุจุฎุด ฺู ูุดฺฉู ุฏุงุฑุฏ.</p></div><footer class=post-footer></footer></article></main><footer class=footer><span>ุชุญุช ูุฌูุฒ <a href=https://creativecommons.org/licenses/by-nc/4.0/>ฺฉุฑุชู ฺฉุงููุฒ ุงุฎุชุงุฑ-ุบุฑุชุฌุงุฑ 4.0 ุจูโุงูููู</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=/parsiya.fa/assets/js/highlight.min.e85ad0406048e8176e1c7661b25d5c69297ddfe41dc4124cf75ecb99a4f7b3d1.js integrity="sha256-6FrQQGBI6BduHHZhsl1caSl93+QdxBJM917LmaT3s9E=" onload=hljs.initHighlightingOnLoad()></script>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById("menu").scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById("menu").scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>